{
  "hash": "25ad1300c8c76be44343db442e5e502f",
  "result": {
    "markdown": "---\ntitle: Custom Word formatting using R Markdown\ndescription: Turning R Markdown into a Word document that contains custom styling\nauthor: Andreas Handel\ndate: '2020-10-07'\naliases: \n  - ../word-formatting-rmarkdown/\ncategories: \n  - R \n  - R Markdown \n  - Word\n  - Tutorial\nimage: \"featured.png\"\n---\n\n\n\n# Background\n\nA good while back (around 2 years as of this writing), I needed the feature to turn an R Markdown document into a Word document (that's easy) and to apply custom styles to specific parts of the Word document (that was trickier). I found some good information [in this RStudio article](https://rmarkdown.rstudio.com/articles_docx.html), but it didn't quite address everything I was looking for.\n\nSpecifically, I wanted to find a way to format certain parts of the R Markdown document in a specific style. I asked online and [got some help](https://rmarkdown.rstudio.com/articles_docx.html#comment-4105255981) from [JJ Allaire](https://github.com/jjallaire) (yes, the guy who started RStudio ðŸ¤©). Then recently, [Dean Attali](https://deanattali.com/) (yes, the guy who does a lot of cool Shiny stuff âœ¨) posted a reply asking for an example. I tried to dig out the 2 year old project (it turns out I ended up not needing it for that project and haven't used it since).\n\nAs I was trying to contemplate how to best share the example with Dean, I figured I'll write a brief blog post, which might benefit others, too. So here it goes.\n\n\n# Word template preparation\n\n* Create a new word document (either through RMarkdown -> Word, or just open Word and create a new empty one).\n* Open the word document. Write a bit of text. It doesn't matter what you write, it's just meant so you can create and apply new styles to it. For instance you can write `Text for mystyle1`.\n* Mark the text you wrote, click on the arrow to the left of the `Styles` box (see the red \"circle\" in the figure) and choose `Create a style`. Depending on your version of Word, this might be somewhere else. Create the formatting the way you want.\n* Repeat to create as many custom styles as you want, save the word document into the folder of your RMarkdown file.\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](wordscreenshot.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n# RMarkdown setup\n\nStart a new Rmarkdown document. Your YAML header should look something like this:\n\n```\n---\ntitle: \"An example of formatting text blocks in Word\"\nauthor: \"Andreas Handel\"\ndocumentclass: article\nsite: bookdown::bookdown_site\noutput:\n  bookdown::word_document2: \n    toc: false\n    reference_docx: wordstyletemplate.docx\n---\n```\n\nNote that I'm using bookdown as the output format here, but any others that can produce word output, e.g. the standard R Markdown format, should work equally well.\nThe important part is the last line, which specifies the word document with the custom styles you created in the previous step.\n\n\n# RMarkdown input content \n\nYou can now assign text blocks in your R markdown file specific styles. Here I created 3 styles called mystyle1/mystyle2/mystyle3 in the Word doc, and assign them to specific parts of the text.\nThis example markdown text shows how to use the styles.\n\n```\n# A regular section\n\nThis text is not getting a special format.\n\n# A formatted Section\n\n:::{custom-style=\"mystyle1\"}\nThis is formatted according to the _mystyle1_ format.\n:::\n\n# Another formatted block of text\n\nSome more regular text.\n\n:::{custom-style=\"mystyle2\"}\nNow text formatted based on _mystyle2_.\n:::\n\nMore regular text.\n\n:::{custom-style=\"mystyle3\"}\nThis format includes a border and it also works with an equation.\n$$Y = bX + c$$\n:::\n\nRegular text again.\n\n::: {custom-style=\"mystyle1\"}\n# With a header\n\nNote that the header formatting is overwritten.\n:::\n```\n\n# Word output \n\nThe resulting word document looks like this:\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](wordoutput.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n# Some notes\n\nOne thing you see in this example is that your own styles overwrite all others, so headers inside your custom style will just be formatted like your custom style. Some other quirks I noticed is that you seem to need empty lines before and after your custom style block. I seem to remember that formatting of R chunks works ok, but I also seem to recall that sometimes manual intervention is required. \n\nOverall, this approach gives you a good deal of flexibility for applying styling to your Word documents when writing in R Markdown, but there might still be some kinks. As I mentioned in the beginning, I ended up not using it for the project I had intended to use it (a review paper I wrote), so I don't have a lot of _real world_ experience beyond what I'm describing here.\n\n\n# Further Resources\n\nYou can get the Word template and the example R Markdown file I used to illustrate this [here](/posts/2020-10-07-custom-word-format/wordstyletemplate.docx) and [here](/posts/2020-10-07-custom-word-format/word_formatting_example.Rmd).\n\nI recently saw that the new R Markdown cookbook has [a section describing word styling](https://bookdown.org/yihui/rmarkdown-cookbook/word-template.html). I expect that more content will be added to the cookbook, so it's worth checking regularly.\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}